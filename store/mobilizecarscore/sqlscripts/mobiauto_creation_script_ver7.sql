SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Table USER
-- -----------------------------------------------------
DROP TABLE IF EXISTS USER ;

SHOW WARNINGS;
CREATE  TABLE IF NOT EXISTS USER (
  UID VARCHAR(8) NOT NULL,
  USERID VARCHAR(8) NOT NULL,
  PASSWORD VARCHAR(512) NOT NULL,
  STATUS VARCHAR(8) NOT NULL,
  USR_TYPE VARCHAR(1) NOT NULL,
  USR_TIMESTAMP TIMESTAMP,
    PRIMARY KEY (UID) )
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

SHOW WARNINGS;
CREATE INDEX USER_idx ON USER (UID ASC) ;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table BUYER_DETAILS
-- -----------------------------------------------------
DROP TABLE IF EXISTS BUYER_DETAILS;

SHOW WARNINGS;
CREATE  TABLE IF NOT EXISTS BUYER_DETAILS (
  UID VARCHAR(8) NOT NULL,
  FIRSTNAME VARCHAR(25) NOT NULL ,
  LASTNAME VARCHAR(25) NOT NULL ,
  ADDRESSLINE1 VARCHAR(25) NOT NULL ,
  ADDRESSLINE2 VARCHAR(25) NULL DEFAULT NULL ,
  CITY VARCHAR(25) NOT NULL ,
  STATE VARCHAR(25) NOT NULL ,
  ZIP VARCHAR(10) NOT NULL,
  LATI DECIMAL(10,6) NOT NULL,
  LONGI DECIMAL(10,6) NOT NULL,
  COUNTRY VARCHAR(25) NULL DEFAULT NULL ,
  HOMEPHONE VARCHAR(12) NULL DEFAULT NULL ,
  MOBILEPHONE VARCHAR(12) NULL DEFAULT NULL ,
  EMAILID VARCHAR(50) NULL DEFAULT NULL ,
  USR_DTL_TIMESTAMP TIMESTAMP,
  
    FOREIGN KEY (UID)
    REFERENCES USER (UID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

SHOW WARNINGS;
CREATE INDEX BUYER_IDX ON BUYER_DETAILS (UID ASC) ;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table SELLER_DETAILS
-- -----------------------------------------------------
DROP TABLE IF EXISTS SELLER_DETAILS;

SHOW WARNINGS;
CREATE  TABLE IF NOT EXISTS SELLER_DETAILS (
  UID VARCHAR(8) NOT NULL,
  FIRSTNAME VARCHAR(25) NOT NULL ,
  LASTNAME VARCHAR(25) NOT NULL ,
  ADDRESSLINE1 VARCHAR(25) NOT NULL ,
  ADDRESSLINE2 VARCHAR(25) NULL DEFAULT NULL ,
  CITY VARCHAR(25) NOT NULL ,
  STATE VARCHAR(25) NOT NULL ,
  ZIP VARCHAR(10) NOT NULL,
  LATI DECIMAL(10,6) NOT NULL,
  LONGI DECIMAL(10,6) NOT NULL,
  COUNTRY VARCHAR(25) NULL DEFAULT NULL ,
  HOMEPHONE VARCHAR(12) NULL DEFAULT NULL ,
  MOBILEPHONE VARCHAR(12) NULL DEFAULT NULL ,
  EMAILID VARCHAR(50) NULL DEFAULT NULL ,
  USR_DTL_TIMESTAMP TIMESTAMP,
  
    FOREIGN KEY (UID)
    REFERENCES USER (UID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

SHOW WARNINGS;
CREATE INDEX SELLER_IDX ON SELLER_DETAILS (UID ASC) ;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table BUYER_CRITERIA
-- -----------------------------------------------------
DROP TABLE IF EXISTS BUYER_CRITERIA;

SHOW WARNINGS;
CREATE  TABLE IF NOT EXISTS BUYER_CRITERIA (
  UID 			VARCHAR(8) NOT NULL,
  CRITID        INT UNSIGNED NOT NULL AUTO_INCREMENT,
  YEAR_FROM   	CHAR(4) NOT NULL,
  YEAR_TO    	CHAR(4) NOT NULL,
  MAKE      	CHAR(25) NOT NULL ,
  MODEL       	CHAR(25) NOT NULL ,
  COLOR 	    CHAR(20) NOT NULL ,
  PRICE_FROM  	DECIMAL(8,2) NOT NULL ,
  PRICE_TO   	DECIMAL(8,2) NOT NULL ,
  MILEAGE     	INT(10) NOT NULL ,
  RADIUS      	SMALLINT NOT NULL,
  YEAR_PREF   	SMALLINT,
  MAKE_PREF     SMALLINT,
  MODEL_PREF    SMALLINT,
  COLOR_PREF 	SMALLINT,
  PRICE_PREF  	SMALLINT,
  MILEAGE_PREF  SMALLINT,
  RADIUS_PREF   SMALLINT,
  USR_CRI_TIMESTAMP TIMESTAMP,
  
  PRIMARY KEY (CRITID),
    FOREIGN KEY (UID)
    REFERENCES USER (UID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

SHOW WARNINGS;
CREATE INDEX BUYER_CRIT_idx ON BUYER_CRITERIA (UID ASC, CRITID ASC) ;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table SEARCH_LOG
-- -----------------------------------------------------
DROP TABLE IF EXISTS SEARCH_LOG ;

SHOW WARNINGS;
CREATE  TABLE IF NOT EXISTS SEARCH_LOG (
  UID VARCHAR(8) NOT NULL ,
  MAKE VARCHAR(25) NULL ,
  MODEL VARCHAR(25) NULL ,
  COLOR VARCHAR(20) NULL ,
  YEAR VARCHAR(4) NULL ,
  SEARCH_LOG_TIMESTAMP TIMESTAMP,
  
    FOREIGN KEY (UID)
    REFERENCES USER (UID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

SHOW WARNINGS;
CREATE INDEX SEARCH_LOG_idx ON SEARCH_LOG (UID ASC) ;

SHOW WARNINGS;
-- -----------------------------------------------------
-- Table SEARCH_CRITERIA
-- -----------------------------------------------------
DROP TABLE IF EXISTS SEARCH_CRITERIA;

SHOW WARNINGS;
CREATE  TABLE IF NOT EXISTS SEARCH_CRITERIA (
  UID VARCHAR(8) NOT NULL ,
  CRITERIAID INT NOT NULL DEFAULT 1 ,
  CRITERIA VARCHAR(1024) NOT NULL ,
  SEARCH_CRI_TIMESTAMP TIMESTAMP,
  
    FOREIGN KEY (UID)
    REFERENCES USER (UID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

SHOW WARNINGS;
CREATE INDEX SEARCH_CRIT_idx ON SEARCH_CRITERIA (UID ASC) ;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table CAR_DETAILS
-- -----------------------------------------------------
DROP TABLE IF EXISTS CAR_DETAILS;

SHOW WARNINGS;
CREATE  TABLE IF NOT EXISTS CAR_DETAILS (
  UID 	VARCHAR(8) NOT NULL ,
  CARID 	VARCHAR(10) NOT NULL ,
  YEAR 	VARCHAR(4) NOT NULL , 
  MAKE 	VARCHAR(25) NOT NULL ,
  MODEL 	VARCHAR(25) NOT NULL ,
  COLOR 	VARCHAR(20) NOT NULL ,
  MILEAGE 	BIGINT(20) NOT NULL ,
  PRICE    	DECIMAL(8,2),
  ZIPCODE    	VARCHAR(6) NOT NULL,
  COMMENTS 	VARCHAR(200),
  CAR_DTL_TIMESTAMP TIMESTAMP,  
  PRIMARY KEY (UID,CARID),
    FOREIGN KEY (UID)
    REFERENCES USER (UID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

SHOW WARNINGS;
CREATE INDEX CAR_DET_idx ON CAR_DETAILS (UID ASC) ;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table CAR_IMAGE
-- -----------------------------------------------------
DROP TABLE IF EXISTS CAR_IMAGE;

SHOW WARNINGS;
CREATE  TABLE IF NOT EXISTS CAR_IMAGE (
  UID 	VARCHAR(8) NOT NULL ,
  CARID 	VARCHAR(8) NOT NULL ,
  IMAGEID 	VARCHAR(10) NOT NULL ,
  IMAGEPATH 	VARCHAR(256) NOT NULL ,
  CAR_IMG_TIMESTAMP TIMESTAMP,
  
    FOREIGN KEY (UID,CARID)
    REFERENCES CAR_DETAILS (UID,CARID)
    ON DELETE NO ACTION
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

SHOW WARNINGS;
CREATE INDEX CAR_IMA_idx ON CAR_IMAGE (CARID ASC) ;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table PAYMENT_DETAILS
-- -----------------------------------------------------
DROP TABLE IF EXISTS PAYMENT_DETAILS;

SHOW WARNINGS;
CREATE  TABLE IF NOT EXISTS PAYMENT_DETAILS (
  UID VARCHAR(8) NOT NULL ,
  CARID VARCHAR(20) NOT NULL ,
  CARDNUMBER VARCHAR(20) NOT NULL ,
  AMOUNT FLOAT(10,2) NOT NULL ,
  TRANSACTIONDATE DATE NOT NULL ,
  PAY_DTL_TIMESTAMP TIMESTAMP,
  
    FOREIGN KEY (UID)
    REFERENCES USER (UID)
    ON DELETE NO ACTION
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

SHOW WARNINGS;
CREATE INDEX PAY_DET_idx ON PAYMENT_DETAILS (UID ASC) ;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table CARD_DETAILS
-- -----------------------------------------------------
DROP TABLE IF EXISTS CARD_DETAILS;

SHOW WARNINGS;
CREATE  TABLE IF NOT EXISTS CARD_DETAILS (
  UID VARCHAR(8) NOT NULL ,
  CARDNUMBER VARCHAR(16) NOT NULL ,
  FIRSTNAME VARCHAR(30) NOT NULL ,
  LASTNAME VARCHAR(30) NOT NULL ,
  EXPDATE DATE NOT NULL ,
  TYPE VARCHAR(10) NOT NULL ,
  CVVCODE VARCHAR(4) NOT NULL ,
  CARD_DTL_TIMESTAMP TIMESTAMP,
  
    FOREIGN KEY (UID)
    REFERENCES USER (UID)
    ON DELETE NO ACTION
    ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

SHOW WARNINGS;
CREATE INDEX CARD_DET_idx ON CARD_DETAILS (UID ASC) ;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table USER_SECURITY
-- -----------------------------------------------------
DROP TABLE IF EXISTS USER_SECURITY;

SHOW WARNINGS;
CREATE  TABLE IF NOT EXISTS USER_SECURITY (
  UID VARCHAR(8) NOT NULL ,
  NOTIFYGN CHAR(1) NULL DEFAULT NULL ,
  NOTIFYYL CHAR(1) NULL DEFAULT NULL ,
  QUESTION1 VARCHAR(50) NULL DEFAULT NULL ,
  ANSWER1 VARCHAR(50) NULL DEFAULT NULL ,
  QUESTION2 VARCHAR(50) NULL DEFAULT NULL ,
  ANSWER2 VARCHAR(50) NULL DEFAULT NULL ,
  USR_PREF2_TIMESTAMP TIMESTAMP,
  
    FOREIGN KEY (UID)
    REFERENCES USER (UID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

SHOW WARNINGS;
CREATE INDEX USER_SECURITY_idx ON USER_SECURITY (UID ASC) ;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table CODE
-- -----------------------------------------------------
DROP TABLE IF EXISTS CODE;

SHOW WARNINGS;
CREATE  TABLE IF NOT EXISTS CODE (
  UID VARCHAR(8) NOT NULL ,
  CODE VARCHAR(128) NOT NULL ,
  CARID VARCHAR(45) NULL ,
  CODE_TIMESTAMP TIMESTAMP,
  
    FOREIGN KEY (UID)
    REFERENCES USER (UID)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

SHOW WARNINGS;
CREATE INDEX CODE_idx ON CODE (UID ASC) ;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table UID_GEN
-- -----------------------------------------------------
DROP TABLE IF EXISTS UID_GEN;

SHOW WARNINGS;
CREATE  TABLE IF NOT EXISTS UID_GEN (
  OBJID TINYINT NOT NULL ,
  OBJTYPE VARCHAR(15) NOT NULL ,
  COUNT BIGINT NOT NULL ,
  UID_GEN_TIMESTAMP TIMESTAMP,
  
  PRIMARY KEY (OBJID) )
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

SHOW WARNINGS;

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table UID_GEN
-- -----------------------------------------------------
START TRANSACTION;
INSERT INTO UID_GEN (`OBJID`, `OBJTYPE`, `COUNT`) VALUES (1, 'USER', 4);
INSERT INTO UID_GEN (`OBJID`, `OBJTYPE`, `COUNT`) VALUES (2, 'SELLER', 1);
INSERT INTO UID_GEN (`OBJID`, `OBJTYPE`, `COUNT`) VALUES (3, 'BUYER', 1);
INSERT INTO UID_GEN (`OBJID`, `OBJTYPE`, `COUNT`) VALUES (4, 'DEALER', 1);
INSERT INTO UID_GEN (`OBJID`, `OBJTYPE`, `COUNT`) VALUES (5, 'AUTO', 1);
INSERT INTO UID_GEN (`OBJID`, `OBJTYPE`, `COUNT`) VALUES (6, 'CAR', 1);

COMMIT;

-- -----------------------------------------------------
-- Data for table USER
-- -----------------------------------------------------
START TRANSACTION;

INSERT INTO USER (`UID`, `USERID`, `PASSWORD`,`STATUS`,`USR_TYPE`,`USR_TIMESTAMP`) VALUES ('UID1','ugandhar','ugandhar','ACTIVE','B',now());
INSERT INTO USER (`UID`, `USERID`, `PASSWORD`,`STATUS`,`USR_TYPE`,`USR_TIMESTAMP`) VALUES ('UID2','sunil','sunil','ACTIVE','B',now());
INSERT INTO USER (`UID`, `USERID`, `PASSWORD`,`STATUS`,`USR_TYPE`,`USR_TIMESTAMP`) VALUES ('UID3','guru','guru','ACTIVE','B',now());

COMMIT;

-- -----------------------------------------------------
-- Data for table CAR_DETAILS
-- -----------------------------------------------------
insert into  CAR_DETAILS values ('UID1','CA1234',2000,'NISAN','LEXUS','BLUE',20000,15000.00,'11211','good',now());
insert into  CAR_DETAILS values ('UID2','CA1235',1980,'HONDA','CRV','GRAY',40000,15000.00,'11222','good',now());
insert into  CAR_DETAILS values ('UID3','CA1236',2004,'TOYOTA','CAMRY','WHITE',25000,15000.00,'10009','good',now());
insert into  CAR_DETAILS values ('UID1','CA1238',2000,'NISAN1','LEXUS1','BLUE',20000,15000.00,'11206','good',now());
insert into  CAR_DETAILS values ('UID2','CA1239',1980,'HONDA1','CRV1','GRAY',40000,15000.00,'10002','good',now());
insert into  CAR_DETAILS values ('UID3','CA1240',2004,'TOYOTA1','CAMRY1','WHITE',25000,15000.00,'11211','good',now());
commit;

-- -----------------------------------------------------
-- Data for table SELLER_DETAILS
-- -----------------------------------------------------
insert into SELLER_DETAILS values('UID1','UGANDHAR','YARABHAM','105 TRACY PL','APT E','HACKENSACK','NJ','07601',0.0,0.0,'USA','1111111111','2222222222','UGU@GMAIL.COM',now());
insert into SELLER_DETAILS values('UID2','SUNIL','KOMMIRSHETTY','208 RT 46','APT E','PARSIPPANY','NJ','07601',0.0,0.0,'USA','3333333333','4444444444','SUNNY@GMAIL.COM',now());
insert into SELLER_DETAILS values('UID3','GURU','TEEGALA','5 VARGENIA ST','','NEW CITY','NY','10962',0.0,0.0,'USA','5555555555','6666666666','GURU@GMAIL.COM',now());
commit;


-- -----------------------------------------------------
-- Data for table BUYER_DETAILS
-- -----------------------------------------------------
insert into BUYER_DETAILS values('UID1','UGANDHAR','YARABHAM','105 TRACY PL','APT E','HACKENSACK','NJ','07601',0.0,0.0,'USA','1111111111','2222222222','UGU@GMAIL.COM',now());
insert into BUYER_DETAILS values('UID2','SUNIL','KOMMIRSHETTY','208 RT 46','APT E','PARSIPPANY','NJ','07601',0.0,0.0,'USA','3333333333','4444444444','SUNNY@GMAIL.COM',now());
insert into BUYER_DETAILS values('UID3','GURU','TEEGALA','5 VARGENIA ST','','NEW CITY','NY','10962',0.0,0.0,'USA','5555555555','6666666666','GURU@GMAIL.COM',now());
commit;
